# Vulnerability Report: CVE-2019-13635

**Plugin:** wp-fastest-cache

**Generated:** 2025-11-09 07:06:31

---

## Overview

**Title:** WP Fastest Cache <= 0.8.9.5 - Directory Traversal

**CVE ID:** CVE-2019-13635

**Vulnerability Type:** Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

**Affected Versions:** <= 0.8.9.5

**Patched Version:** None

**Wordfence UUID:** 07fc1249-a50d-4038-8cbe-35ff7a3d28b3


## Severity Information

**Exploitability Score:** 5.0

**Quality Score:** 0.9


## Detected Patterns

**All Detected Patterns:**

- `TYPE_CAST:array`


**Incidental Patterns (general security):**

- `TYPE_CAST:array`


## Signature Pattern

```
Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')::TYPE_CAST[array]
```


## Validation Notes

- [INFO] Single pattern signature (high confidence)

- [WARNING] No primary patterns match vulnerability type - may be misclassified

- [INFO] More incidental than primary patterns - multiple issues fixed together


## Code Changes Statistics

- **Files Changed:** 5

- **PHP Files:** 3

- **Lines Added:** 53

- **Lines Removed:** 24


## Unified Diff (Git-style)

```diff

diff -ruN wp-fastest-cache-0.8.9.5/inc/admin.php wp-fastest-cache-0.9.0/inc/admin.php
--- wp-fastest-cache-0.8.9.5/inc/admin.php	2019-07-01 10:00:00.000000000 +0000
+++ wp-fastest-cache-0.9.0/inc/admin.php	2019-07-15 12:00:00.000000000 +0000
@@ -150,10 +150,17 @@
 			}

+			$language_negotiation_type = apply_filters('wpml_setting', false, 'language_negotiation_type');
+			if(($language_negotiation_type == 2) && $this->isPluginActive('sitepress-multilingual-cms/sitepress.php')){
+				$cache_path = '/cache/all/%{HTTP_HOST}/';
+				$disable_condition = true;
+			}else{
+				$cache_path = '/cache/all/';
+				$disable_condition = false;
+			}
+
-				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME."/cache/all/$1/index.html -f"."\n";
-				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME."/cache/all/$1/index.html -f [or]"."\n";
-				$data = $data."RewriteCond ".$tmp_WPFC_WP_CONTENT_DIR."/cache/all/".$this->getRewriteBase(true)."$1/index.html -f"."\n";
-			$data = $data.'RewriteRule ^(.*) "/'.$this->getRewriteBase().WPFC_WP_CONTENT_BASENAME.'/cache/all/'.$this->getRewriteBase(true).'$1/index.html" [
+				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME.$cache_path."$1/index.html -f"."\n";
+				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME.$cache_path."$1/index.html -f [or]"."\n";
+				$data = $data."RewriteCond ".$tmp_WPFC_WP_CONTENT_DIR.$cache_path.$this->getRewriteBase(true)."$1/index.html -f"."\n";
+			$data = $data.'RewriteRule ^(.*) "/'.$this->getRewriteBase().WPFC_WP_CONTENT_BASENAME.$cache_path.$this->getRewriteBase(true).'$1/index.html" [

diff -ruN wp-fastest-cache-0.8.9.5/inc/cache.php wp-fastest-cache-0.9.0/inc/cache.php
--- wp-fastest-cache-0.8.9.5/inc/cache.php	2019-07-01 10:00:00.000000000 +0000
+++ wp-fastest-cache-0.9.0/inc/cache.php	2019-07-15 12:00:00.000000000 +0000
@@ -85,6 +85,11 @@
 			    $this->cacheFilePath = str_replace('/cache/all/', '/cache/all/'.$current_language.'/', $this->cacheFilePath);
 			}

+			// for security
+			if(preg_match("/\.{2,}/", $this->cacheFilePath)){
+				$this->cacheFilePath = false;
+			}
+
 		}else if(isset($value->prefix) && $value->prefix && ($value->type == "page")){
 			if($buffer && preg_match("/^(homepage|category|tag|post|page|archive|attachment)$/", $value->prefix)){
 				if($preg_match_rule){
diff -ruN wp-fastest-cache-0.8.9.5/js/cdn/cdn.js wp-fastest-cache-0.9.0/js/cdn/cdn.js
--- wp-fastest-cache-0.8.9.5/js/cdn/cdn.js	2019-07-01 10:00:00.000000000 +0000
+++ wp-fastest-cache-0.9.0/js/cdn/cdn.js	2019-07-15 12:00:00.000000000 +0000
@@ -245,7 +245,13 @@
 				}
 			},
 			show_button: function(button_type){
-				self.show_button("back");
+				if(current_page.attr("wpfc-cdn-page") == 2){
+					if(self.id == "maxcdn"){
+						self.show_button("back");
+					}
+				}else{
+					self.show_button("back");
+				}
 			},
 			set_cdn_values_for_update: function(res){
 				if(res.content_type){


```


## Code Differences

This section shows the actual code changes between the vulnerable and patched versions.


### Vulnerable Code (Before Patch)

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/inc/admin.php`

```php

				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME."/cache/all/$1/index.html -f"."\n";
				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME."/cache/all/$1/index.html -f [or]"."\n";
				$data = $data."RewriteCond ".$tmp_WPFC_WP_CONTENT_DIR."/cache/all/".$this->getRewriteBase(true)."$1/index.html -f"."\n";
			$data = $data.'RewriteRule ^(.*) "/'.$this->getRewriteBase().WPFC_WP_CONTENT_BASENAME.'/cache/all/'.$this->getRewriteBase(true).'$1/index.html" [


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/inc/cache.php`

```php

			//WPML language switch
			//https://wpml.org/forums/topic/wpml-language-switch-wp-fastest-cache-issue/
			$language_negotiation_type = apply_filters('wpml_setting', false, 'language_negotiation_type');
			if ($this->isPluginActive('sitepress-multilingual-cms/sitepress.php') && 2 == $language_negotiation_type){
			    $current_language = apply_filters('wpml_current_language', false);
			    
			    $this->cacheFilePath = str_replace('/cache/all/', '/cache/all/'.$current_language.'/', $this->ca


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/js/cdn/cdn.js`

```php

				self.show_button("back");

```


### Patched Code (After Patch)

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/inc/admin.php`

```php

			$language_negotiation_type = apply_filters('wpml_setting', false, 'language_negotiation_type');
			if(($language_negotiation_type == 2) && $this->isPluginActive('sitepress-multilingual-cms/sitepress.php')){
				$cache_path = '/cache/all/%{HTTP_HOST}/';
				$disable_condition = true;
			}else{
				$cache_path = '/cache/all/';
				$disable_condition = false;
			}

				$data = $data."RewriteCond %{DOCUMENT_ROOT}/".WPFC_WP_CONTENT_BASENAME.$cache_path."$1/index.html -f"."\n";
				$data = $data."R


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/inc/cache.php`

```php


			// for security
			if(preg_match("/\.{2,}/", $this->cacheFilePath)){
				$this->cacheFilePath = false;
			}
					}else if(isset($value->prefix) && $value->prefix && ($value->type == "page")){
						if($buffer && preg_match("/^(homepage|category|tag|post|page|archive|attachment)$/", $value->prefix)){
							if($preg_match_rule){
								if(preg_match("/".$preg_match_rule."/i", $request_url)){
									return true;
								}


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/js/cdn/cdn.js`

```php

				if(current_page.attr("wpfc-cdn-page") == 2){
					if(self.id == "maxcdn"){
						self.show_button("back");
					}
				}else{
					self.show_button("back");
				}

```


### Key Changes Summary

**Files modified:** 3
- `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/inc/admin.php`: 5 lines → 12 lines
- `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/inc/cache.php`: 8 lines → 12 lines
- `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.8.9.5/js/cdn/cdn.js`: 1 lines → 7 lines


---

*Report extracted at: 2025-11-09T06:57:38.487925*
