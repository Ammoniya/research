# Vulnerability Report: CVE-2021-20714

**Plugin:** wp-fastest-cache

**Generated:** 2025-11-09 06:53:08

---

## Overview

**Title:** WP Fastest Cache <= 0.9.1.6 - Authenticated (Admin+) Directory Traversal to Arbitrary File Deletion

**CVE ID:** CVE-2021-20714

**Vulnerability Type:** Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

**Affected Versions:** <= 0.9.1.6

**Patched Version:** None

**Wordfence UUID:** 20989781-def0-4ffd-bf24-40ed34b3e922


## Severity Information

**Exploitability Score:** 5.0

**Quality Score:** 0.7000000000000001


## Detected Patterns

**All Detected Patterns:**

- `AUTH:current_user_can`

- `CAPABILITY:manage_options`


**Incidental Patterns (general security):**

- `AUTH:current_user_can`

- `CAPABILITY:manage_options`


## Signature Pattern

```
Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')::AUTH[current_user_can]|CAPABILITY[manage_options]
```


## Validation Notes

- [WARNING] No primary patterns match vulnerability type - may be misclassified

- [INFO] More incidental than primary patterns - multiple issues fixed together


## Code Changes Statistics

- **Files Changed:** 7

- **PHP Files:** 5

- **Lines Added:** 142

- **Lines Removed:** 47


## Code Differences

This section shows the actual code changes between the vulnerable and patched versions.


### Vulnerable Code (Before Patch)

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/cache.php`

```php

						if(is_writable($this->getWpContentDir()) || ((is_dir($this->getWpContentDir()."/cache")) && (is_writable($this->getWpContentDir()."/cache")))){
				   					if(!file_exists(WPFC_WP_CONTENT_DIR."/cache/index.html")){
				   						@file_put_contents(WPFC_WP_CONTENT_DIR."/cache/index.html", "");
				   					if(!file_exists(WPFC_WP_CONTENT_DIR."/cache/wpfc-minified/index.html")){
				   						@file_put_contents(WPFC_WP_CONTENT_DIR."/cache/wpfc-minified/index.html", "");


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/single-preload.php`

```php

			$screen = get_current_screen();
			if($screen->parent_base == "edit" && $screen->base == "post"){
				?>
			    <div id="wpfc-single-preload" class="notice notice-info is-dismissible" style="display: none;">
			        <p id="wpfc-single-preload-info"><?php _e('Cache is generated for this content', 'wp-fastest-cache');?><label style="display: none;" id="wpfc-single-preload-error">0</label><label id="wpfc-single-preload-process" style="padding-left: 5px;"><span>0</span>/<span><?php echo count(


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/js/cdn/cdn.js`

```php

		    		modal.find(".wpfc-cdn-pages-container div.wiz-cont:visible #cdn-url").nextAll("label").html(res.error_message);

```


### Patched Code (After Patch)

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/cache.php`

```php

						if(is_writable($this->getWpContentDir()) || ((is_dir($this->getWpContentDir("/cache"))) && (is_writable($this->getWpContentDir("/cache"))))){
				   					if(!file_exists($this->getWpContentDir("/cache/index.html"))){
				   						@file_put_contents($this->getWpContentDir("/cache/index.html"), "");
				   					if(!file_exists($this->getWpContentDir("/cache/wpfc-minified/index.html"))){
				   						@file_put_contents($this->getWpContentDir("/cache/wpfc-minified/index.html"), "");


```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/single-preload.php`

```php

	    public static function add_meta_box(){
	          add_meta_box( 
	             'auto_cache_custom_meta_box', // this is HTML id
	             'Auto Cache Settings', 
	             array("SinglePreloadWPFC", "auto_cache_custom_box_html"), // the callback function
	             array('page', 'post', 'product'),
	             'side',
	             'high'
	          );
	    }

	    public static function auto_cache_custom_box_html(){
	        if($data = get_option("WpFastestCache_autocache")){



```

#### File: `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/js/cdn/cdn.js`

```php

		    		if(WpfcCDN.id == "cloudflare"){
		    			modal.find("label.wiz-error-msg").html(res.error_message);
		    		}else{
		    			modal.find(".wpfc-cdn-pages-container div.wiz-cont:visible #cdn-url").nextAll("label").html(res.error_message);
		    		}

```


### Key Changes Summary

**Files modified:** 3
- `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/cache.php`: 6 lines → 6 lines
- `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/single-preload.php`: 6 lines → 15 lines
- `/home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/js/cdn/cdn.js`: 1 lines → 5 lines


---

*Report extracted at: 2025-11-09T06:46:45.788793*
