# Data Directory Structure

This directory contains all input and output data for the WordPress vulnerability research project, keeping the codebase clean and separating code from execution results.

## Directory Structure

```
data/
├── input/              # Input data files (source data)
│   ├── top_10k_plugin_slugs.txt        # List of top 10,000 WordPress plugins
│   ├── plugin_vulnerabilities.json      # Processed vulnerability mappings
│   └── wordfence_db.json                # Wordfence vulnerability database
│
└── output/             # All generated/output data
    ├── signatures/     # Vulnerability signatures (organized by plugin)
    ├── mining_results/ # Vulnerability mining results
    │   ├── timelines/           # Vulnerability timeline data
    │   ├── zero_days/           # Zero-day findings
    │   ├── metrics/             # Research metrics
    │   └── cache/               # SVN revision cache
    ├── fuzz_results/   # Fuzzing validation results
    │   ├── crashes/             # Crash data
    │   ├── validated/           # Validated vulnerabilities
    │   ├── false_positives/     # False positive findings
    │   └── exploits/            # PoC exploits
    └── reports/        # Generated vulnerability reports
```

## Path Configuration

All paths are centrally managed in `/data_paths.py`. This module provides:

- Consistent path references across all scripts
- Automatic directory creation
- Helper functions for generating file paths

### Usage Example

```python
from data_paths import (
    INPUT_PLUGIN_LIST,
    OUTPUT_SIGNATURES_DIR,
    get_signature_file_path,
    ensure_data_directories
)

# Ensure all directories exist
ensure_data_directories()

# Read input file
with open(INPUT_PLUGIN_LIST, 'r') as f:
    plugins = f.read().splitlines()

# Get path for signature file
sig_path = get_signature_file_path('plugin-slug', 'CVE-2024-1234')
```

## Input Data Files

### top_10k_plugin_slugs.txt
- Generated by: `utils/fetch_plugins.py`
- Contains: 10,000 most popular WordPress plugin slugs
- Format: One plugin slug per line
- Update: Run `python utils/fetch_plugins.py` to refresh

### wordfence_db.json
- Generated by: `utils/download_wordfence_db.py`
- Contains: Complete Wordfence vulnerability database
- Format: JSON with UUID keys
- Update: Run `python utils/download_wordfence_db.py` to refresh

### plugin_vulnerabilities.json
- Generated by: `utils/process_vulnerabilities.py`
- Contains: Cross-referenced plugin-to-vulnerability mapping
- Format: JSON with plugin slug keys
- Update: Run `python utils/process_vulnerabilities.py` after updating above files

## Output Data

All output data is automatically generated in the `data/output/` directory. The directory structure is created automatically when running the main scripts.

### Signatures
- Generated by: `generate_signatures.py`
- Location: `data/output/signatures/{plugin_slug}/{cve}.json`
- Contains: Vulnerability signatures with code patterns

### Mining Results
- Generated by: `mine_vulnerability_clones.py`
- Location: `data/output/mining_results/`
- Contains: Historical analysis, timelines, zero-day findings, metrics

### Fuzz Results
- Generated by: `validate_zero_days.py`
- Location: `data/output/fuzz_results/`
- Contains: Fuzzing validation results, crash data, exploits

### Reports
- Generated by: `utils/generate_vulnerability_report.py`
- Location: `data/output/reports/`
- Contains: Markdown vulnerability reports

## Git Configuration

The `.gitignore` file is configured to:
- Ignore all input data files (large files)
- Ignore all output data (generated results)
- Track the directory structure via `.gitkeep` files

This ensures the repository stays clean while preserving the directory layout.

## Migration from Legacy Structure

The project has been refactored to use this centralized data structure. Legacy paths that are now deprecated:

- ~~`plugin_vulnerabilities.json`~~ → `data/input/plugin_vulnerabilities.json`
- ~~`top_10k_plugin_slugs.txt`~~ → `data/input/top_10k_plugin_slugs.txt`
- ~~`wordfence_db.json`~~ → `data/input/wordfence_db.json`
- ~~`signatures/`~~ → `data/output/signatures/`
- ~~`mining_results/`~~ → `data/output/mining_results/`
- ~~`fuzz_results/`~~ → `data/output/fuzz_results/`
- ~~`reports/`~~ → `data/output/reports/`

All scripts have been updated to use the new paths automatically.
