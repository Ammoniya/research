{
  "cve": "CVE-2021-20714",
  "plugin_slug": "wp-fastest-cache",
  "vuln_type": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
  "signature_type": "security_function_pattern",
  "pattern": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')::AUTH[current_user_can]|CAPABILITY[manage_options]",
  "context": {
    "title": "WP Fastest Cache <= 0.9.1.6 - Authenticated (Admin+) Directory Traversal to Arbitrary File Deletion",
    "affected_versions": "<= 0.9.1.6",
    "patched_version": null,
    "wordfence_uuid": "20989781-def0-4ffd-bf24-40ed34b3e922",
    "detected_patterns": [
      "AUTH:current_user_can",
      "CAPABILITY:manage_options"
    ],
    "file_changes": 7,
    "quality_score": 0.7000000000000001
  },
  "primary_patterns": [],
  "incidental_patterns": [
    "AUTH:current_user_can",
    "CAPABILITY:manage_options"
  ],
  "severity_indicators": [],
  "exploitability_score": 5.0,
  "diff_before": "File: /home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/cache.php\n\t\t\t\t\t\tif(is_writable($this->getWpContentDir()) || ((is_dir($this->getWpContentDir().\"/cache\")) && (is_writable($this->getWpContentDir().\"/cache\")))){\n\t\t\t\t   \t\t\t\t\tif(!file_exists(WPFC_WP_CONTENT_DIR.\"/cache/index.html\")){\n\t\t\t\t   \t\t\t\t\t\t@file_put_contents(WPFC_WP_CONTENT_DIR.\"/cache/index.html\", \"\");\n\t\t\t\t   \t\t\t\t\tif(!file_exists(WPFC_WP_CONTENT_DIR.\"/cache/wpfc-minified/index.html\")){\n\t\t\t\t   \t\t\t\t\t\t@file_put_contents(WPFC_WP_CONTENT_DIR.\"/cache/wpfc-minified/index.html\", \"\");\n\nFile: /home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/single-preload.php\n\t\t\t$screen = get_current_screen();\n\t\t\tif($screen->parent_base == \"edit\" && $screen->base == \"post\"){\n\t\t\t\t?>\n\t\t\t    <div id=\"wpfc-single-preload\" class=\"notice notice-info is-dismissible\" style=\"display: none;\">\n\t\t\t        <p id=\"wpfc-single-preload-info\"><?php _e('Cache is generated for this content', 'wp-fastest-cache');?><label style=\"display: none;\" id=\"wpfc-single-preload-error\">0</label><label id=\"wpfc-single-preload-process\" style=\"padding-left: 5px;\"><span>0</span>/<span><?php echo count(\n\nFile: /home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/js/cdn/cdn.js\n\t\t    \t\tmodal.find(\".wpfc-cdn-pages-container div.wiz-cont:visible #cdn-url\").nextAll(\"label\").html(res.error_message);",
  "diff_after": "File: /home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/cache.php\n\t\t\t\t\t\tif(is_writable($this->getWpContentDir()) || ((is_dir($this->getWpContentDir(\"/cache\"))) && (is_writable($this->getWpContentDir(\"/cache\"))))){\n\t\t\t\t   \t\t\t\t\tif(!file_exists($this->getWpContentDir(\"/cache/index.html\"))){\n\t\t\t\t   \t\t\t\t\t\t@file_put_contents($this->getWpContentDir(\"/cache/index.html\"), \"\");\n\t\t\t\t   \t\t\t\t\tif(!file_exists($this->getWpContentDir(\"/cache/wpfc-minified/index.html\"))){\n\t\t\t\t   \t\t\t\t\t\t@file_put_contents($this->getWpContentDir(\"/cache/wpfc-minified/index.html\"), \"\");\n\nFile: /home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/inc/single-preload.php\n\t    public static function add_meta_box(){\n\t          add_meta_box( \n\t             'auto_cache_custom_meta_box', // this is HTML id\n\t             'Auto Cache Settings', \n\t             array(\"SinglePreloadWPFC\", \"auto_cache_custom_box_html\"), // the callback function\n\t             array('page', 'post', 'product'),\n\t             'side',\n\t             'high'\n\t          );\n\t    }\n\n\t    public static function auto_cache_custom_box_html(){\n\t        if($data = get_option(\"WpFastestCache_autocache\")){\n\n\nFile: /home/ravindu/compweb/svn_wordpress_org/wp-fastest-cache/tags/0.9.1.6/js/cdn/cdn.js\n\t\t    \t\tif(WpfcCDN.id == \"cloudflare\"){\n\t\t    \t\t\tmodal.find(\"label.wiz-error-msg\").html(res.error_message);\n\t\t    \t\t}else{\n\t\t    \t\t\tmodal.find(\".wpfc-cdn-pages-container div.wiz-cont:visible #cdn-url\").nextAll(\"label\").html(res.error_message);\n\t\t    \t\t}",
  "diff_stats": {
    "file_changes": 7,
    "php_files": 5,
    "total_lines_added": 142,
    "total_lines_removed": 47
  },
  "extracted_at": "2025-11-09T06:46:45.788793",
  "validated": true,
  "validation_notes": [
    "[WARNING] No primary patterns match vulnerability type - may be misclassified",
    "[INFO] More incidental than primary patterns - multiple issues fixed together"
  ]
}
